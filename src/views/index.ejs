<% /* レイアウトは server.js の express-ejs-layouts に任せる。ここで layout() は呼ばない。 */ %>

<!-- ===== ヒーロー写真：自動ローテーション（商用可：Unsplash / Pexels） ===== -->
<style>
  /* 完全フルブリード（左右の余白をゼロに） */
  .bleed-tight{
    margin-left:calc(50% - 50vw);
    margin-right:calc(50% - 50vw);
    width:100vw;
  }

  .hero-rotator{
    position:relative;
    width:100%;
    height:clamp(420px, 88vh, 1000px);
    background:#000; overflow:hidden;
  }
  @supports (height: 88dvh){
    .hero-rotator{ height:clamp(420px, 88dvh, 1000px); }
  }

  .hero-rotator .slide{
    position:absolute; inset:0; opacity:0; transition:opacity .8s ease;
  }
  .hero-rotator .slide.on{ opacity:1; }
  .hero-rotator img{ width:100%; height:100%; object-fit:cover; display:block; }

  /* ⬇ キャプション：主張しすぎない半透明バー＋読みやすいタイポ */
  .hero-rotator .cap{
    position:absolute; left:4%; right:4%; bottom:6%;
    padding:12px 14px; color:#fff; font-weight:800;
    font-size:clamp(18px, 3.8vw, 26px); letter-spacing:.04em; line-height:1.2;
    background:linear-gradient(180deg, rgba(0,0,0,.08), rgba(0,0,0,.36));
    border-radius:12px;
    border:1px solid rgba(255,255,255,.12);
    backdrop-filter: blur(3px);
    box-shadow:0 8px 28px rgba(0,0,0,.25);
  }
  /* デスクトップは少し控えめに */
  @media (min-width:920px){
    .hero-rotator .cap{ font-size:clamp(18px, 2.2vw, 24px); bottom:5%; }
    .hero-rotator{ border-radius:16px; }
  }

  .dots{
    position:absolute; left:0; right:0; bottom:12px;
    display:flex; justify-content:center; gap:6px; pointer-events:none;
  }
  .dot{width:6px; height:6px; border-radius:999px; background:#cbd5e1; opacity:.9}
  .dot.on{ background:#ffffff; }
</style>

<div class="bleed-tight">
  <div class="hero-rotator" id="heroRotator" aria-label="インスピレーション写真">
    <!-- 1. 紙吹雪のライブ（華やか） -->
    <figure class="slide on">
      <img src="https://images.unsplash.com/photo-1492684223066-81342ee5ff30?auto=format&fit=crop&w=1600&q=80"
           alt="紙吹雪が舞う大規模ライブの熱狂" width="1600" height="900" />
      <figcaption class="cap">スポットライトは、あなたへ。</figcaption>
    </figure>
    <!-- 2. 強い照明のシンガー -->
    <figure class="slide">
      <img src="https://images.unsplash.com/photo-1470225620780-dba8ba36b745?auto=format&fit=crop&w=1600&q=80"
           alt="強い照明の中で歌うシンガー" width="1600" height="900" />
      <figcaption class="cap">一歩、光の中へ。</figcaption>
    </figure>
    <!-- 3. 機内窓の夕焼け（世界へ） -->
    <figure class="slide">
      <img src="https://images.unsplash.com/photo-1529070538774-1843cb3265df?auto=format&fit=crop&w=1600&q=80"
           alt="飛行機の窓から見る夕焼け" width="1600" height="900" />
      <figcaption class="cap">次の目的地は、世界。</figcaption>
    </figure>
    <!-- 4. 花火の夜景（達成の祝福） -->
    <figure class="slide">
      <img src="https://images.unsplash.com/photo-1469474968028-56623f02e42e?auto=format&fit=crop&w=1600&q=80"
           alt="花火が上がる都市の夜景" width="1600" height="900" />
      <figcaption class="cap">努力は、必ず祝われる。</figcaption>
    </figure>
    <!-- 5. ラグジュアリーな家族の時間 -->
    <figure class="slide">
      <img src="https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=1600"
           alt="明るいリビングでの家族の団欒" width="1600" height="1067" />
      <figcaption class="cap">大切な人と、豊かな時間を。</figcaption>
    </figure>

    <div class="dots" id="heroDots" aria-hidden="true">
      <div class="dot on"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
    </div>
  </div>
</div>

<section class="hero">
  <h1>なぜ学ぶのか、を決めよう。</h1>
  <p class="lead">
    AIとの対話で、最終目標と道筋を明確化。今日から動ける「最初の一歩」へ。
  </p>
  <form method="post" action="/start">
    <button class="btn cta" type="submit"
      style="padding:20px 26px; font-size:18px; border-radius:18px;
             box-shadow:0 18px 40px rgba(31,111,235,.26), 0 10px 22px rgba(16,185,129,.18);">
      はじめる（¥100）
    </button>
  </form>
  <div class="chips" style="margin-top:12px">
    <span class="chip">安全なStripe決済</span>
    <span class="chip">所要10〜15分</span>
    <span class="chip">保存なし（MVP）</span>
  </div>
</section>

<section class="features">
  <div class="feature">
    <h3>AI対話で自己発見</h3>
    <p>雑念を削ぎ落とし、価値観と願望を言語化。</p>
  </div>
  <div class="feature">
    <h3>あなただけの羅針盤</h3>
    <p>ぶれない“軸”を一文で定義。選択が速くなる。</p>
  </div>
  <div class="feature">
    <h3>最初の一歩</h3>
    <p>今週やることまで分解。今日から動ける。</p>
  </div>
</section>

<script>
  // 自動ローテーション（互換重視）
  document.addEventListener('DOMContentLoaded', function(){
    var rotator = document.getElementById('heroRotator');
    if (!rotator) return;
    var slides = rotator.querySelectorAll('.slide');
    var dotsWrap = document.getElementById('heroDots');
    var dots = dotsWrap ? dotsWrap.children : [];
    var i = 0, intervalMs = 4500;

    function show(n){
      if (!slides.length) return;
      if (slides[i]) slides[i].classList.remove('on');
      if (dots[i]) dots[i].classList.remove('on');
      i = (n + slides.length) % slides.length;
      if (slides[i]) slides[i].classList.add('on');
      if (dots[i]) dots[i].classList.add('on');
    }
    setInterval(function(){ show(i + 1); }, intervalMs);
  });
</script>
